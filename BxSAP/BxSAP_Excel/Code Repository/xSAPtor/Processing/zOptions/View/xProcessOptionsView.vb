Imports System.ComponentModel
Imports System.Windows.Forms
'••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••
Namespace Main.Process.Options
	Friend Class xProcessOptionsView
								Implements ixProcessOptionsView

		#Region "Definitions"

			Private WithEvents	co_VM		As ixProcessOptionsVM
			Private							co_DTO	As ixProcessOptionsDTO

		#End Region
		'¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
		#Region "Form Handling"

			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Friend Sub HandleVisibility()

				If Me.Visible
					If Me.WindowState = FormWindowState.Minimized
						Me.WindowState = FormWindowState.Normal
					Else
						Me.Hide()
					End If
				Else
					Me.Show()
				End If

			End Sub
			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Private Sub EventHandler_Shutdown()

				Me.Close()

			End Sub

			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Private Sub xSAPtorLogonOptions_Load(sender As Object,
																					 e			As EventArgs) _
										Handles Me.Load

				Me.co_DTO	= Me.co_VM.FetchOptions()

				Me.xnud_NoOfProcesses.Value			= CDec(Me.co_DTO.ParallelProcessesTran)
				Me.xchb_RunMonAutoOpen.Checked	= Me.co_DTO.RunMonitorAutoStart
				Me.xnud_RunMonRate.Value				= CDec(Me.co_DTO.RunMonitorRefreshRate)

				Me.co_VM.ViewActive	= True

			End Sub
			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Private Sub xSAPtorLogonOptions_Closing(sender	As Object,
																							e				As CancelEventArgs) _
										Handles Me.Closing

				Me.co_DTO.ParallelProcessesTran	= CUInt(Me.xnud_NoOfProcesses.Value)
				Me.co_DTO.RunMonitorAutoStart		= Me.xchb_RunMonAutoOpen.Checked
				Me.co_DTO.RunMonitorRefreshRate	= Me.xnud_RunMonRate.Value

				If Me.co_VM.SaveOptions(i_Options:= Me.co_DTO)
				End If

				RemoveHandler co_VM.ev_ToggleViewVisibility,
											AddressOf	Me.HandleVisibility

				RemoveHandler	co_VM.ev_ShutdownView,
											AddressOf	Me.EventHandler_Shutdown

				Me.co_VM.ViewActive	= False

			End Sub
			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Private Sub ev_FormEscape(	sender	As Object,
																	e				As KeyEventArgs) _
										Handles Me.KeyDown

				If e.KeyCode.Equals(Keys.Escape)	Then	Me.Close()

			End Sub

		#End Region
		'¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
		#Region "Constructor/Destruction: Methods & Events"

			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Friend Sub New(ByVal OptionsVM As ixProcessOptionsVM)

				InitializeComponent()

				Me.co_VM	= OptionsVM

				AddHandler	co_VM.ev_ToggleViewVisibility,
										AddressOf	Me.HandleVisibility

				AddHandler	co_VM.ev_ShutdownView,
										AddressOf	Me.EventHandler_Shutdown

			End Sub

		#End Region

	End Class

End Namespace