Imports System.IO
Imports System.Threading
Imports System.Xml
Imports System.Xml.Serialization
Imports System.Runtime.Serialization
Imports System.Security.AccessControl
Imports System.Security.Principal
'••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••
Namespace Services.Utilities.Generic

	Friend	Class	ServicesGeneric
									Implements iServicesGeneric

		#Region "Properties"

			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Friend	ReadOnly	Property	UserLocalAppDataFolder()  As String _
																		Implements iServicesGeneric.UserLocalAppDataFolder
				Get
					Return	Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData)
				End Get
			End Property
			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Friend	ReadOnly	Property	UserLocalAppThisappSubFolder(	Optional	ByVal suffix	As String	= "" )	As String _
													Implements iServicesGeneric.UserLocalAppThisappSubFolder
				Get
					Return	String.Concat( Me.UserLocalAppDataFolder, "\", Me.AppName(suffix) )
				End Get
			End Property
			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Friend	ReadOnly	Property	AppName(	Optional	ByVal suffix	As String	= "" ) As String _
																		Implements iServicesGeneric.AppName
			    Get

						Dim lc_Name	As String

						If My.Application.Info.Title.Length > 0 Then
							lc_Name	= My.Application.Info.Title 
						Else
							lc_Name	= Path.GetFileNameWithoutExtension(My.Application.Info.AssemblyName)
						End If
				
						If suffix.Length > 0	Then	lc_Name	= String.Concat(lc_Name, suffix)

						Return	lc_Name

			    End Get
			End Property
			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Friend	ReadOnly	Property	UserLocalAppThisappPathName(	Optional	ByVal suffix	As String	= "",
																														Optional	ByVal ext			As String	= ".XML"	)	As String _
																		Implements iServicesGeneric.UserLocalAppThisappPathName
			    Get
						Return String.Concat(Me.UserLocalAppThisappSubFolder, "\", Me.AppName(suffix), ext)
			    End Get
			End Property

		#End Region
		'¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
		#Region "Methods"

			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Friend	Function	CreateUserLocalThisappFolder(	Optional	ByVal suffix	As String	= "" ) As Boolean _
													Implements iServicesGeneric.CreateUserLocalThisappFolder

				Try

						Dim lc_File	= UserLocalAppThisappSubFolder()

						If Not Directory.Exists(lc_File)

							Dim securityRules As DirectorySecurity  = New DirectorySecurity()
							Dim userSid       As SecurityIdentifier = WindowsIdentity.GetCurrent().User

							securityRules.AddAccessRule(New FileSystemAccessRule(userSid,
																																		FileSystemRights.FullControl,
																																		InheritanceFlags.ContainerInherit Or InheritanceFlags.ObjectInherit,
																																		PropagationFlags.None,
																																		AccessControlType.Allow))

							Directory.CreateDirectory(lc_File)  ', securityRules)

						End If

						Return True

					Catch ex As Exception
						Return False

				End Try

			End Function

		#End Region
		'¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
		#Region "Constructors"

			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Private	Shared	ReadOnly	_Instance	As	Lazy(Of iServicesGeneric) _
																								= New Lazy(Of iServicesGeneric)(
																										Function()	New	ServicesGeneric,
																										LazyThreadSafetyMode.ExecutionAndPublication	)
			Friend Shared ReadOnly Property ServicesGeneric	As iServicesGeneric
				Get
						Return _Instance.Value
				End Get
			End Property
			'¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨¨
			Private Sub New()
			End Sub

		#End Region

	End Class

End Namespace
